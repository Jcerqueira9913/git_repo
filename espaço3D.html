<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Space 3D - Transformações Lineares</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/110/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
  <script>

    const cena = new THREE.Scene();

    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.z = 5;

    const renderizador = new THREE.WebGLRenderer({ antialias: true });
    renderizador.setSize(window.innerWidth, window.innerHeight);
    renderizador.setPixelRatio(window.devicePixelRatio);
    document.body.appendChild(renderizador.domElement);

    const eixoMaterial = new THREE.LineBasicMaterial({ color: 0xaaaaaa });

    const eixoX = new THREE.Line(new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(-10, 0, 0), new THREE.Vector3(10, 0, 0)]), eixoMaterial);
    cena.add(eixoX);

    const eixoY = new THREE.Line(new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(0, -10, 0), new THREE.Vector3(0, 10, 0)]), eixoMaterial);
    cena.add(eixoY);

    const eixoZ = new THREE.Line(new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(0, 0, -10), new THREE.Vector3(0, 0, 10)]), eixoMaterial);
    cena.add(eixoZ);

    function atualizarCamera() {
      const mouseX = event.clientX - window.innerWidth / 2;
      const mouseY = event.clientY - window.innerHeight / 2;
      camera.position.x = mouseX * 0.005;
      camera.position.y = -mouseY * 0.005;
      camera.lookAt(cena.position);
    }


    document.addEventListener('mousemove', atualizarCamera);

    function adicionarVetoresTransformados(vetores_transformados) {

      const grupo = new THREE.Group();

      vetores_transformados.forEach(vetor => {
        const pontoInicial = new THREE.Vector3(0, 0, 0);
        const pontoFinal = new THREE.Vector3(vetor[0], vetor[1], vetor[2]);

        const linha = new THREE.Line(new THREE.BufferGeometry().setFromPoints([pontoInicial, pontoFinal]), new THREE.LineBasicMaterial({ color: 0xff0000 }));
        grupo.add(linha);
      });

      cena.add(grupo);
    }

    //criar pasta com json para receber os valores
    $.getJSON('transformacao_linear.json', function(dados) {
      const vetores_transformados = dados.vetores_transformados;
      adicionarVetoresTransformados(vetores_transformados);
    });

    function renderizar() {
      requestAnimationFrame(renderizar);
      renderizador.render(cena, camera);
    }

    renderizar();
  </script>
</body>
</html>
